<!doctype html>

<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

     	<title>How to host your static site with HTTPS on GitHub Pages and CloudFlare | by Robin</title>

    	<meta name="description" content="The combination of the free services from CloudFlare and Github Pages make it incredibly easy to host a secure website.">
        <meta name="viewport" content="width=device-width">

        <link rel="canonical" href="https://robinwinslow.uk/2016/02/13/free-https-custom-hosting/" />

        <link type="text/css" rel="stylesheet" href="/assets/global-cde306f7329733dd6abd0056b28c2061da3b79079c896e4286449114bfff9d39.css">

        <script>
            if (location.hostname=="robinwinslow.uk") {
                var _gaq=[
                    ['_require', 'inpage_linkid', '//www.google-analytics.com/plugins/ga/inpage_linkid.js'],
                    ['_setAccount','UA-2993676-8'],
                    ['_trackPageview']
                ];
                (function() {
                    var ga = document.createElement('script');
                    ga.type = 'text/javascript';
                    ga.async = true;
                    ga.src = '//www.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            }
        </script>

        <link type="application/atom+xml" rel="alternative" href="/rss.xml" />
    </head>

    <body class="">
        <!--[if lt IE 9]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/?locale=en">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <header class="site-header">
            <h1>The blog of <a href="/">Robin</a></h1>

            <nav class="inline-navigation site-navigation">
                <ul>
                    <li class=""><a href="/dev/">Web dev</a></li>
                    <li class=""><a href="/politics/">Politics</a></li>
                    <li class=""><a href="/musings/">Musings</a></li>
                    <li class=""><a href="/">All articles</a></li>
                </ul>
            </nav>
        </header>

        <article>
    <header class="page-header">
        <date>13 Feb 2016</date>

        <h1>How to host your static site with HTTPS on GitHub Pages and CloudFlare</h1>
    </header>

    <p>There has been a <a href="https://www.chapterthree.com/blog/why-your-site-should-be-using-https" title="Why your site should be using HTTPS">growing</a> <a href="https://www.youtube.com/watch?v=cBhZ6S0PFCY" title="Google I/O 2014 - HTTPS Everywhere">movement</a> to get all websites to use SSL
connections where possible. Nowadays, Google even <a href="https://googlewebmastercentral.blogspot.co.uk/2014/08/https-as-ranking-signal.html" title="Google Webmaster Central Blog: HTTPS as a ranking signal">uses it as a criterion</a> for
ranking websites.</p>

<p>I&#39;ve written before about <a href="/2014/08/26/host-your-site-with-https-for-free/" title="Robin Winslow: Host your site with HTTPS for free">how to host an HTTPS website for free with StartSSL
and OpenShift</a>. However, StartSSL is very hard to use and provides
very basic certificates, and setting up a website on OpenShift is a fairly technical
undertaking.</p>

<p>There now exists <a href="https://sheharyar.me/blog/free-ssl-for-github-pages-with-custom-domains/" title="Sheharyar Naseer: Set Up SSL on Github Pages With Custom Domains for Free">a much simpler way to setup an HTTPS website</a> with
<a href="https://www.cloudflare.com/" title="CloudFlare is a free global CDN and DNS provider that can speed up and protect any site online">CloudFlare</a> and <a href="https://pages.github.com/" title="Github Pages: Websites for you and your projects">GitHub Pages</a>. This only works for static sites.</p>

<p>If your site is more complicated and needs a database or dynamic functionality,
or you need an SHA-1 fallback certificate (explained below)
then look at my other post about <a href="/2014/08/26/host-your-site-with-https-for-free/" title="Robin Winslow: Host your site with HTTPS for free">the OpenShift solution</a>. However,
if a static site works for you, read on.</p>

<h1 id="github-pages">GitHub Pages</h1>

<p>As most developers will be aware by now, GitHub offer a fantastic free
static website hosting solution in <a href="https://pages.github.com/" title="Github Pages: Websites for you and your projects">GitHub Pages</a>.</p>

<p>All you have to do is <a href="https://help.github.com/articles/creating-project-pages-manually/" title="GitHub help: Creating Project Pages manually">put your HTML files in the <code>gh-pages</code> branch</a> of one of
your repositories and they will be served as a website at
<code>{username}.github.io/{project-name}</code>.</p>

<p><img src="http://i.imgur.com/DBeJSBN.png" alt="GitHub pages minimal files"></p>

<p>And all files are passed through the
<a href="https://jekyllrb.com/" title="Jekyll: Transform your plain text into static websites and blogs.">Jekyll</a> parser first, so if you want to split up your HTML into templates
you can. And if you don&#39;t want to craft your site by hand, you can use the
<a href="https://github.com/blog/1081-instantly-beautiful-project-pages" title="GitHub: Instantly Beautiful Project Pages">Automatic Page Generator</a>.</p>

<p><img src="https://camo.githubusercontent.com/d60800ddc54bf9d0317ca901e7fb14590167f7fd/68747470733a2f2f6769746875622d696d616765732e73332e616d617a6f6e6177732e636f6d2f626c6f672f323031322f706167652d67656e657261746f722d7069636b65722e706e67" alt="automatic page generator themes"></p>

<p>Websites on <code>github.io</code> also <a href="https://konklone.com/post/github-pages-now-sorta-supports-https-so-use-it" title="Eric Mill: GitHub Pages Now (Sorta) Supports HTTPS, So Use It">support HTTPS</a>, so you can serve your site up
at <code>https://{username}.github.io/{project-name}</code> if you want.</p>

<p><img src="http://i.imgur.com/2ZvKJEP.png" alt="mytestwebsite GitHub pages"></p>

<p>GitHub Pages also <a href="https://help.github.com/articles/setting-up-a-custom-domain-with-github-pages/" title="GitHub help: Setting up a custom domain with GitHub Pages">support custom domains</a> (still for free). Just add a <code>CNAME</code>
file to the repository with your domain name in it - e.g.
<code>mytestwebsite.robinwinslow.uk</code> - and then go and setup the <a href="https://en.wikipedia.org/wiki/CNAME_record" title="Wikipedia: CNAME record">DNS CNAME</a>
to point to <code>{username}.github.io</code>.</p>

<p><img src="http://i.imgur.com/7EF2uwyg.png" alt="mytestwebsite GitHub pages files"></p>

<p>The only thing you can&#39;t do directly with GitHub Pages is offer HTTPS
on your custom domain - e.g. <code>https://mytestwebsite.robinwinslow.uk</code>. This is where
CloudFlare comes in.</p>

<h1 id="cloudflare">CloudFlare</h1>

<p>CloudFlare offer a really quite impressive free DNS and CDN service. This free
service includes some really impressive offerings, the first three of which
are especially helpful for our current HTTPS mission:</p>

<ul>
<li><a href="https://blog.cloudflare.com/introducing-universal-ssl/" title="CloudFlare: Introducing Universal SSL">Free automatic HTTPS for your domain</a> - no need to buy a certificate</li>
<li><a href="https://support.cloudflare.com/hc/en-us/articles/200168306-Is-there-a-tutorial-for-Page-Rules-" title="CloudFlare support: Is there a tutorial for Page Rules?">Page Rules</a> - custom settings and redirects for URL patterns</li>
<li><a href="https://blog.cloudflare.com/enforce-web-policy-with-hypertext-strict-transport-security-hsts/" title="CloudFlare: Enforce Web Policy with HTTP Strict Transport Security (HSTS)">HTTP Strict Transport Security</a> (HSTS) - protection from <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" title="Wikipedia: Man-in-the-middle attack">MITM attacks</a></li>
<li><a href="https://www.cloudflare.com/dnssec/universal-dnssec/" title="CloudFlare Universal DNSSEC">DNSSEC</a> - protection from DNS poisoning attacks</li>
<li><a href="https://www.cloudflare.com/http2/" title="CloudFlare HTTP/2">HTTP/2</a> - optimised connections for browsers that support it</li>
<li><a href="https://blog.cloudflare.com/introducing-cname-flattening-rfc-compliant-cnames-at-a-domains-root/" title="CloudFlare: Introducing CNAME Flattening: RFC-Compliant CNAMEs at a Domain&#39;s Root">CNAME flattening</a> - so you can use a <a href="https://en.wikipedia.org/wiki/CNAME_record" title="Wikipedia: CNAME record">DNS CNAME</a> at the domain apex</li>
<li><a href="https://www.cloudflare.com/always-online/" title="CloudFlare: Always Online™">&quot;Always online&quot; protection</a> - Your cached website will stay up even if the host goes down</li>
<li><a href="https://www.cloudflare.com/features-security/" title="CloudFlare: Security">Firewall</a> - intelligent protection against <a href="https://en.wikipedia.org/wiki/Denial-of-service_attack" title="Wikipedia: Denial-of-service attack">DDOS attacks</a></li>
</ul>

<p>The most important downside to CloudFlare&#39;s free tier SSL is that it doesn&#39;t
include the <a href="https://blog.cloudflare.com/sha-1-deprecation-no-browser-left-behind/" title="CloudFlare blog: SHA-1 Deprecation: No Browser Left Behind">fall-back to legacy SHA-1 for older browsers</a>.
This means that the most out-of-date (and therefore probably the poorest) 1.5%
of global citizens won&#39;t be able to access your site without upgrading their
browser. If this is important to you, either find a different HTTPS solution or
upgrade to a <a href="https://www.cloudflare.com/plans/" title="CloudFlare: Plans">paid CloudFlare account</a>.</p>

<h2 id="setting-up-https">Setting up HTTPS</h2>

<p>Because CloudFlare are a CDN <em>and</em> a DNS host, they can do the HTTPS negotiation
for you. They&#39;ve taken advantage of this to provide you with a free HTTPS
certificate to encrypt communication between your users and their cached site.</p>

<p>First simply setup your DNS with CloudFlare to point to <code>{username}.github.io</code>,
and allow CloudFlare to cache the site.</p>

<p><img src="http://i.imgur.com/VxPqzgFg.png" alt="mytestwebsite CloudFlare DNS setup"></p>

<p>Between CloudFlare and your host the connection doesn&#39;t have to be encrypted,
but I would certainly suggest that it still should be. But crucially for us,
this encrypted connection doesn&#39;t actually need a <em>valid</em> HTTPS certificate. To
enable this we should select the &quot;Full&quot; (rather than &quot;Flexible&quot; or &quot;Strict&quot;)
option.</p>

<p><img src="http://i.imgur.com/olf2JH2g.png" alt="CloudFlare full SSL encryption"></p>

<p>Et voilà! You now have an encrypted custom domain in front of
GitHub Pages completely for free!</p>

<p><img src="http://i.imgur.com/eBgFJqp.png" alt="mytestwebsite with a secure domain"></p>

<h1 id="ensuring-all-visitors-use-https">Ensuring all visitors use HTTPS</h1>

<p>To make our site properly secure, we need to ensure all users are sent
to the HTTPS site (<code>https://mytestwebsite.robinwinslow.uk</code>) instead of the HTTP
one (<code>http://mytestwebsite.robinwinslow.uk</code>).</p>

<h2 id="setting-up-a-page-rule">Setting up a page rule</h2>

<p>The first step to get visitors to use HTTPS is to send a <a href="https://moz.com/learn/seo/redirection" title="MOZ: Redirection">301 redirect</a>
from <code>http://mytestwebsite.robinwinslow.uk</code> to <code>https://mytestwebsite.robinwinslow.uk</code>.</p>

<p>Although this is not supported with GitHub Pages, it <a href="https://support.cloudflare.com/hc/en-us/articles/200170536-How-do-I-redirect-all-visitors-to-HTTPS-SSL-" title="CloudFlare support: How do I redirect all visitors to HTTPS/SSL?">can be achieved</a> with
CloudFlare page rules.</p>

<p>Just add a page rule for <code>http://*{your-domain.com}/*</code> (e.g. <code>http://*robinwinslow.uk/*</code>)
and turn on &quot;Always use HTTPS&quot;:</p>

<p><img src="http://i.imgur.com/1l6tyIAg.png" alt="CloudFlare always use HTTPS page rule"></p>

<p>Now we can check that our domain is redirecting users to HTTPS
by inspecting the headers:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>curl -I mytestwebsite.robinwinslow.uk
HTTP/1.1 301 Moved Permanently
...
Location: https://mytestwebsite.robinwinslow.uk/
</code></pre></div>
<h2 id="http-strict-transport-security-hsts">HTTP Strict Transport Security (HSTS)</h2>

<p>To protect our users from <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" title="Wikipedia: Man-in-the-middle attack">man-in-the-middle attacks</a>, we should also
turn on <a href="https://blog.cloudflare.com/enforce-web-policy-with-hypertext-strict-transport-security-hsts/" title="CloudFlare blog: Enforce Web Policy with HTTP Strict Transport Security (HSTS)">HSTS with CloudFlare</a> (still for free). Note that this can cause
problems if you&#39;re ever planning on removing HTTPS from your site.</p>

<p>If you&#39;re using a subdomain (e.g. <code>mytestwebsite.robinwinslow.uk</code>),
remember to enable &quot;Apply HSTS policy to subdomains&quot;.</p>

<p><img src="http://i.imgur.com/tYam5yng.png" alt="CloudFlare: HSTS setting"></p>

<p>This will tell <a href="http://caniuse.com/#feat=stricttransportsecurity" title="Can I use... Strict Transport Security">modern browsers</a> to always use the HTTPS protocol for this domain.</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="gp">$ </span>curl -I https://mytestwebsite.robinwinslow.uk
HTTP/1.1 200 OK
...
Strict-Transport-Security: max-age<span class="o">=</span>15552000; includeSubDomains; preload
X-Content-Type-Options: nosniff
</code></pre></div>
<p>It can take several weeks for your domain to make it into the
<a href="https://hstspreload.appspot.com/" title="Chromium HSTS preload list">Chromium HSTS preload list</a>. You can check if it&#39;s in there, or add it
again, by visiting <code>chrome://net-internals/#hsts</code> in a Chrome or Chromium
browser and looking for the <code>static_sts_domain</code> setting.</p>

<h1 id="thats-it">That&#39;s it!</h1>

<p>You now have an incredibly quick and easy way to put a fully secure website
online in minutes, totally for free!</p>


<!-- Generate subnav for article -->
<script type="text/javascript" src="/assets/subnav-020636817964deb048fb98c55583f2981ff145d2db5e13d5c3b624c4ef8613f4.js"></script>


    <hr>

    <nav class="tags-list muted">
        <label>Tags</label>

        <ul>

            <li><a href="/postsbytag/#dev">dev</a></li>

        </ul>
    </nav>


<hr/>

<div id="disqus_thread" class="comments"></div>

</article>


<nav class="related-nav article-index">
    <h1>Similar articles</h1>

    <ul>
    
        
            
                <li>
    <article>
        <a href="/2016/06/23/fix-docker-networking-dns/">
            <date>23 Jun 2016</date>
            <h1>Fix Docker's networking DNS config</h1>
            <p>Within certain networks, docker is unable to resolve DNS correctly. When this happens, here's how to fix it.</p>
        </a>


        <nav class="tags-list muted">
            <label>Tags</label>

            <ul>

                <li><a href="/postsbytag/#back-end">back-end</a></li>

                <li><a href="/postsbytag/#dev">dev</a></li>

                <li><a href="/postsbytag/#canonical">canonical</a></li>

            </ul>
        </nav>

    </article>
</li>

            
        
            
                <li>
    <article>
        <a href="/2016/02/25/adding-cache-headers-to-django/">
            <date>25 Feb 2016</date>
            <h1>Django HTTP headers: Controlling caching on cn.ubuntu.com</h1>
            <p>As optimising web performance becomes more and more important, it's becoming essential to carefully manage your caching headers. But Django doesn't make it hat easy.</p>
        </a>


        <nav class="tags-list muted">
            <label>Tags</label>

            <ul>

                <li><a href="/postsbytag/#dev">dev</a></li>

            </ul>
        </nav>

    </article>
</li>

            
        
            
                <li>
    <article>
        <a href="/2016/02/14/simplest-wsgi-application/">
            <date>14 Feb 2016</date>
            <h1>Creating a minimal Python application server for experimenting</h1>
            <p>As a web developer, it can be incredibly useful to be able to spin up a quick server to inspect and manipulate raw requests. And if you're used to working in Python, this little script is just the ticket.</p>
        </a>


        <nav class="tags-list muted">
            <label>Tags</label>

            <ul>

                <li><a href="/postsbytag/#dev">dev</a></li>

                <li><a href="/postsbytag/#back-end">back-end</a></li>

            </ul>
        </nav>

    </article>
</li>

            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
            
        
    
    </ul>
</nav>


<script>
    if (location.hostname=="robinwinslow.uk") {
        var disqus_shortname = 'robin-blog'; // required: replace example with your forum shortname

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    }
</script>

<noscript>Please enable JavaScript to view the comments (powered by <a href="http://disqus.com/?ref_noscript">Disqus</a>)</noscript>


        <footer class="site-footer">
            <nav class="vcard" id="contact-information">
                <h1>Contact information</h1>

                <ul>
                    <li><a href="mailto:robin+blog@robinwinslow.uk" class="email">robin@robinwinslow.uk</a></li>
                    <li><a href="tel:07795070704" class="tel">07795070704</a></li>
                    <li><a href="https://www.google.co.uk/maps?q=ng7">NG7, Nottingham, UK</a></li>
                </ul>
            </nav>

            <nav>
                <h1>Further writing</h1>

                <ul>
                    <li><a href="http://cv.robinwinslow.uk">cv.robinwinslow.uk</a></li>
                    <li><a href="http://design.canonical.com/author/nottrobin/">design.canonical.com</a></li>
                    </li>
                </ul>
            </nav>

            <nav>
                <h1>Profiles</h1>

                <ul>
                    <li><a href="https://twitter.com/nottrobin">twitter.com (@nottrobin)</a></li>
                    <li><a href="https://facebook.com/robinwinslowmorris">facebook.com (robinwinslowmorris)</a></li>
                    <li><a href="https://github.com/nottrobin/">github.com (nottrobin)</a>
                </ul>
            </nav>

            <p>
                All articles are written by me, <a href="https://plus.google.com/104026832761488144614" rel="author">Robin Winslow</a>, unless otherwise stated. Feel free to use any of my writing, but please <a href="http://creativecommons.org/licenses/by/4.0/">give me attribution</a>.
            </p>

            <p>You're free to download this entire site <a href="https://github.com/nottrobin/robinwinslow.uk/">from github</a>, and <a href="http://creativecommons.org/publicdomain/zero/1.0/">do whatever you like</a> with the code.</p>

            <p><a href="https://github.com/nottrobin/robinwinslow.uk/" class="github-fork">Fork me on github.</a></p>
        </footer>
		<!--[if !(lt IE 8)]><!-->
		<script type="text/javascript">
		  (function(){
			var e = document.createElement('script'); e.type='text/javascript'; e.async = true;
			e.src = 'https://www.eff.org/ngw/widget.min.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(e, s);
		  })();
		</script>
		<!--<![endif]-->
    </body>
</html>
